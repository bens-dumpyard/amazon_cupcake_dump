/*! For license information please see index.js.LICENSE.txt */
var Skill=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=11)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(e,t,r,o){this.requestId=n.v4(),this.requestMessage=e,this.transportProtocol=t,this.onSuccess=r,this.onFailure=o}return e.prototype.getRequestId=function(){return this.requestId},e.prototype.getTransportProtocol=function(){return this.transportProtocol},e.prototype.getRequestMessage=function(){return this.requestMessage},e.prototype.onSuccess=function(e){return this.onSuccessCallback(e)},e.prototype.onFailure=function(e){return this.onFailureCallback(e)},e}();t.RequestContext=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.RAW_TCP=0]="RAW_TCP",e[e.RAW_UDP=1]="RAW_UDP",e[e.HTTP=2]="HTTP"}(t.TransportProtocol||(t.TransportProtocol={}))},function(e,t,r){var n=r(13),o=r(14),i=o;i.v1=n,i.v4=o,e.exports=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectiveResponseCreator=void 0;var n=r(18),o=r(2),i=r(21),a=function(){function e(){}return e.createResponse=function(e,t){return{context:t,event:{endpoint:{endpointId:e},header:{messageId:o.v4(),name:"Response",namespace:"Alexa",payloadVersion:"3"},payload:{}}}},e.createErrorResponse=function(e,t,r){return void 0===r&&(r=""),{event:{endpoint:{endpointId:r},header:{messageId:o.v4(),name:"ErrorResponse",namespace:"Alexa",payloadVersion:"3"},payload:{message:t,type:e}}}},e.createIdentifyEndpointsResponse=function(t){var r=t.payload.response,a=r.MODEL;if(null==a)return e.createInternalErrorResponse("Product type not received");if(0===a.length)return e.createInternalErrorResponse("Product type is empty");if(!i.ProductInfoHelper.isDeviceSupported(r.SUPPORT))return e.createInternalErrorResponse("Product not supported");var s=i.ProductInfoHelper.getCapabilityFlags(r.SUPPORT);return{event:{header:{messageId:o.v4(),name:"Discover.Response",namespace:"Alexa.Discovery",payloadVersion:"3"},payload:{endpoints:[{additionalAttributes:{customIdentifier:parseInt(r.ID,16).toString(),firmwareVersion:r.FW_VER,model:r.MODEL},capabilities:i.ProductInfoHelper.getCapabilities(s),connections:[{type:"TCP_IP"}],cookie:{productCapabilityFlags:JSON.stringify(s)},description:this.SKILL_NAME+" "+a,displayCategories:i.ProductInfoHelper.getDisplayCategories(a),endpointId:n(e.SKILL_NAME+r.ID),friendlyName:0===r.NAME.length?"":r.NAME,manufacturerName:this.SKILL_NAME}]}}}},e.createDeviceStateResponse=function(t,r,n){var o=[];return e.pushDeviceStateProperties(o,r,n),e.createResponse(t,{properties:o})},e.pushDeviceStateProperties=function(e,t,r){var n={brightness:!0,color:!0,colorTemperature:!0};void 0!==r&&(n=r),e.push({name:"powerState",namespace:"Alexa.PowerController",timeOfSample:(new Date).toUTCString(),uncertaintyInMilliseconds:0,value:t.power}),n.brightness&&void 0!==t.brightness&&e.push({name:"brightness",namespace:"Alexa.BrightnessController",timeOfSample:(new Date).toUTCString(),uncertaintyInMilliseconds:0,value:t.brightness}),n.color&&void 0!==t.color&&e.push({name:"color",namespace:"Alexa.ColorController",timeOfSample:(new Date).toUTCString(),uncertaintyInMilliseconds:0,value:t.color}),n.colorTemperature&&void 0!==t.colorTemperatureInKelvin&&e.push({name:"colorTemperatureInKelvin",namespace:"Alexa.ColorTemperatureController",timeOfSample:(new Date).toUTCString(),uncertaintyInMilliseconds:0,value:t.colorTemperatureInKelvin})},e.createInternalErrorResponse=function(t){var r=e.className+":: "+t;return console.debug(r),e.createErrorResponse("INTERNAL_ERROR",r)},e.className="DirectiveResponseCreator",e.SKILL_NAME="Yeelight",e}();t.DirectiveResponseCreator=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12);t.HttpRequestContext=n.HttpRequestContext;var o=r(0);t.RequestContext=o.RequestContext;var i=r(15);t.TCPRequestContext=i.TCPRequestContext;var a=r(1);t.TransportProtocol=a.TransportProtocol;var s=r(16);t.UDPRequestContext=s.UDPRequestContext},function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);e.exports=function(){return r(n),n}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,o=r;return[o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]]].join("")}},function(e,t){var r={utf8:{stringToBytes:function(e){return r.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(r.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Base64Util=void 0;var n=function(){function e(){}return e.enc=function(e){return"undefined"!=typeof Base64?Base64.encode(e):new Buffer(e).toString("base64")},e.dec=function(e){return"undefined"!=typeof Base64?Base64.decode(e):new Uint8Array(new Buffer(e,"base64"))},e}();t.Base64Util=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextWrapper=void 0;var n=function(){function e(){}return e.TEXT_ENCODER_TYPE="undefined"!=typeof TextEncoder?TextEncoder:r(10).TextEncoder,e.TEXT_DECODER_TYPE="undefined"!=typeof TextDecoder?TextDecoder:r(10).TextDecoder,e}();t.TextWrapper=n},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},o=/%[sdj%]/g;t.format=function(e){if(!v(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(s(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),u=n[r];r<i;u=n[++r])y(u)||!b(u)?a+=" "+u:a+=" "+s(u);return a},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var i,a={};function s(e,r){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),m(r)?n.showHidden=r:r&&t._extend(n,r),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=u),l(n,e,n.depth)}function u(e,t){var r=s.styles[t];return r?"["+s.colors[r][0]+"m"+e+"["+s.colors[r][1]+"m":e}function c(e,t){return e}function l(e,r,n){if(e.customInspect&&r&&_(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return v(o)||(o=l(e,o,n)),o}var i=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(v(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(h(t))return e.stylize(""+t,"number");if(m(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}(e,r);if(i)return i;var a=Object.keys(r),s=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),C(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return p(r);if(0===a.length){if(_(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(R(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(T(r))return e.stylize(Date.prototype.toString.call(r),"date");if(C(r))return p(r)}var c,b="",P=!1,E=["{","}"];(f(r)&&(P=!0,E=["[","]"]),_(r))&&(b=" [Function"+(r.name?": "+r.name:"")+"]");return R(r)&&(b=" "+RegExp.prototype.toString.call(r)),T(r)&&(b=" "+Date.prototype.toUTCString.call(r)),C(r)&&(b=" "+p(r)),0!==a.length||P&&0!=r.length?n<0?R(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),c=P?function(e,t,r,n,o){for(var i=[],a=0,s=t.length;a<s;++a)O(t,String(a))?i.push(d(e,t,r,n,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(d(e,t,r,n,o,!0))})),i}(e,r,n,s,a):a.map((function(t){return d(e,r,n,s,t,P)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(c,b,E)):E[0]+b+E[1]}function p(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,r,n,o,i){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),O(n,o)||(a="["+o+"]"),s||(e.seen.indexOf(u.value)<0?(s=y(r)?l(e,u.value,null):l(e,u.value,r-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),g(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function f(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function y(e){return null===e}function h(e){return"number"==typeof e}function v(e){return"string"==typeof e}function g(e){return void 0===e}function R(e){return b(e)&&"[object RegExp]"===P(e)}function b(e){return"object"==typeof e&&null!==e}function T(e){return b(e)&&"[object Date]"===P(e)}function C(e){return b(e)&&("[object Error]"===P(e)||e instanceof Error)}function _(e){return"function"==typeof e}function P(e){return Object.prototype.toString.call(e)}function E(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(g(i)&&(i=e.env.NODE_DEBUG||""),r=r.toUpperCase(),!a[r])if(new RegExp("\\b"+r+"\\b","i").test(i)){var n=e.pid;a[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else a[r]=function(){};return a[r]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=m,t.isNull=y,t.isNullOrUndefined=function(e){return null==e},t.isNumber=h,t.isString=v,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=g,t.isRegExp=R,t.isObject=b,t.isDate=T,t.isError=C,t.isFunction=_,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(27);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(){var e=new Date,t=[E(e.getHours()),E(e.getMinutes()),E(e.getSeconds())].join(":");return[e.getDate(),S[e.getMonth()],t].join(" ")}function O(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",I(),t.format.apply(t,arguments))},t.inherits=r(28),t._extend=function(e,t){if(!t||!b(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var A="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function w(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(A&&e[A]){var t;if("function"!=typeof(t=e[A]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),A&&Object.defineProperty(t,A,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=A,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var o=r.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};t.apply(this,r).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(w,t,a)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(26))},function(e,t,r){"use strict";var n=r(4),o=r(17),i=r(3),a=r(22),s=function(){function e(e,t,r){this.blueprintStore=e,this.actionOrchestrator=t,null==e&&(this.blueprintStore=new a.OrchestrationBlueprintStore),null==t&&(this.actionOrchestrator=new o.ActionOrchestrator),this.onIdInitialized=r}return e.prototype.executeDirective=function(t,r,o,a){console.debug(e.className+":: Executing directive: "+JSON.stringify(t));var s=t.directive,u="",c={};if(void 0!==s.endpoint&&(u=s.endpoint.endpointId,c=s.endpoint.cookie),!r.isSupportedTransportProtocol(n.TransportProtocol.RAW_TCP)){var l=e.className+" requires TCP relay support to work!";return console.error(l),a(i.DirectiveResponseCreator.createErrorResponse("INTERNAL_ERROR",l,u))}var p=s.header.namespace,d=s.header.name,f=this.blueprintStore.getBlueprint(s.header);if(null===f){l=e.className+":: Directive with namespace: "+p+" and name: "+d+" not supported!";return console.error(l),a(i.DirectiveResponseCreator.createErrorResponse("INVALID_DIRECTIVE",l,u))}var m=1+Math.floor(999900*Math.random());return void 0!==this.onIdInitialized&&this.onIdInitialized(m),this.actionOrchestrator.orchestrateAction(f,{cookie:c,endpointId:u,payload:s.payload,executionInfo:{initialResponse:s.payload},requestRelay:r,endOrchestration:!1,commandId:m},o,a)},e.className="YeeLightSkill",e}();e.exports=s},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(1),s=function(e){function t(t,r,n){return e.call(this,t,a.TransportProtocol.HTTP,r,n)||this}return o(t,e),t}(i.RequestContext);t.HttpRequestContext=s},function(e,t,r){var n,o,i=r(5),a=r(6),s=0,u=0;e.exports=function(e,t,r){var c=t&&r||0,l=t||[],p=(e=e||{}).node||n,d=void 0!==e.clockseq?e.clockseq:o;if(null==p||null==d){var f=i();null==p&&(p=n=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==d&&(d=o=16383&(f[6]<<8|f[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:u+1,h=m-s+(y-u)/1e4;if(h<0&&void 0===e.clockseq&&(d=d+1&16383),(h<0||m>s)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=m,u=y,o=d;var v=(1e4*(268435455&(m+=122192928e5))+y)%4294967296;l[c++]=v>>>24&255,l[c++]=v>>>16&255,l[c++]=v>>>8&255,l[c++]=255&v;var g=m/4294967296*1e4&268435455;l[c++]=g>>>8&255,l[c++]=255&g,l[c++]=g>>>24&15|16,l[c++]=g>>>16&255,l[c++]=d>>>8|128,l[c++]=255&d;for(var R=0;R<6;++R)l[c+R]=p[R];return t||a(l)}},function(e,t,r){var n=r(5),o=r(6);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[i+s]=a[s];return t||o(a)}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(1),s=function(e){function t(t,r,n){return e.call(this,t,a.TransportProtocol.RAW_TCP,r,n)||this}return o(t,e),t}(i.RequestContext);t.TCPRequestContext=s},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),a=r(1),s=function(e){function t(t,r,n){return e.call(this,t,a.TransportProtocol.RAW_UDP,r,n)||this}return o(t,e),t}(i.RequestContext);t.UDPRequestContext=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionOrchestrator=void 0;var n=r(3),o=function(){function e(){}return e.prototype.orchestrateAction=function(e,t,r,o){var i=this;if(e.actions.length<1||t.endOrchestration)return e.finalResponseCreator.createResponse(t,r,o);e.actions.shift().perform(t,(function(){return i.orchestrateAction(e,t,r,o)}),(function(e){return o(n.DirectiveResponseCreator.createErrorResponse(e.type,e.message,t.endpointId))}))},e}();t.ActionOrchestrator=o},function(e,t,r){var n,o,i,a,s;n=r(19),o=r(7).utf8,i=r(20),a=r(7).bin,(s=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?a.stringToBytes(e):o.stringToBytes(e):i(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var r=n.bytesToWords(e),u=8*e.length,c=1732584193,l=-271733879,p=-1732584194,d=271733878,f=0;f<r.length;f++)r[f]=16711935&(r[f]<<8|r[f]>>>24)|4278255360&(r[f]<<24|r[f]>>>8);r[u>>>5]|=128<<u%32,r[14+(u+64>>>9<<4)]=u;var m=s._ff,y=s._gg,h=s._hh,v=s._ii;for(f=0;f<r.length;f+=16){var g=c,R=l,b=p,T=d;c=m(c,l,p,d,r[f+0],7,-680876936),d=m(d,c,l,p,r[f+1],12,-389564586),p=m(p,d,c,l,r[f+2],17,606105819),l=m(l,p,d,c,r[f+3],22,-1044525330),c=m(c,l,p,d,r[f+4],7,-176418897),d=m(d,c,l,p,r[f+5],12,1200080426),p=m(p,d,c,l,r[f+6],17,-1473231341),l=m(l,p,d,c,r[f+7],22,-45705983),c=m(c,l,p,d,r[f+8],7,1770035416),d=m(d,c,l,p,r[f+9],12,-1958414417),p=m(p,d,c,l,r[f+10],17,-42063),l=m(l,p,d,c,r[f+11],22,-1990404162),c=m(c,l,p,d,r[f+12],7,1804603682),d=m(d,c,l,p,r[f+13],12,-40341101),p=m(p,d,c,l,r[f+14],17,-1502002290),c=y(c,l=m(l,p,d,c,r[f+15],22,1236535329),p,d,r[f+1],5,-165796510),d=y(d,c,l,p,r[f+6],9,-1069501632),p=y(p,d,c,l,r[f+11],14,643717713),l=y(l,p,d,c,r[f+0],20,-373897302),c=y(c,l,p,d,r[f+5],5,-701558691),d=y(d,c,l,p,r[f+10],9,38016083),p=y(p,d,c,l,r[f+15],14,-660478335),l=y(l,p,d,c,r[f+4],20,-405537848),c=y(c,l,p,d,r[f+9],5,568446438),d=y(d,c,l,p,r[f+14],9,-1019803690),p=y(p,d,c,l,r[f+3],14,-187363961),l=y(l,p,d,c,r[f+8],20,1163531501),c=y(c,l,p,d,r[f+13],5,-1444681467),d=y(d,c,l,p,r[f+2],9,-51403784),p=y(p,d,c,l,r[f+7],14,1735328473),c=h(c,l=y(l,p,d,c,r[f+12],20,-1926607734),p,d,r[f+5],4,-378558),d=h(d,c,l,p,r[f+8],11,-2022574463),p=h(p,d,c,l,r[f+11],16,1839030562),l=h(l,p,d,c,r[f+14],23,-35309556),c=h(c,l,p,d,r[f+1],4,-1530992060),d=h(d,c,l,p,r[f+4],11,1272893353),p=h(p,d,c,l,r[f+7],16,-155497632),l=h(l,p,d,c,r[f+10],23,-1094730640),c=h(c,l,p,d,r[f+13],4,681279174),d=h(d,c,l,p,r[f+0],11,-358537222),p=h(p,d,c,l,r[f+3],16,-722521979),l=h(l,p,d,c,r[f+6],23,76029189),c=h(c,l,p,d,r[f+9],4,-640364487),d=h(d,c,l,p,r[f+12],11,-421815835),p=h(p,d,c,l,r[f+15],16,530742520),c=v(c,l=h(l,p,d,c,r[f+2],23,-995338651),p,d,r[f+0],6,-198630844),d=v(d,c,l,p,r[f+7],10,1126891415),p=v(p,d,c,l,r[f+14],15,-1416354905),l=v(l,p,d,c,r[f+5],21,-57434055),c=v(c,l,p,d,r[f+12],6,1700485571),d=v(d,c,l,p,r[f+3],10,-1894986606),p=v(p,d,c,l,r[f+10],15,-1051523),l=v(l,p,d,c,r[f+1],21,-2054922799),c=v(c,l,p,d,r[f+8],6,1873313359),d=v(d,c,l,p,r[f+15],10,-30611744),p=v(p,d,c,l,r[f+6],15,-1560198380),l=v(l,p,d,c,r[f+13],21,1309151649),c=v(c,l,p,d,r[f+4],6,-145523070),d=v(d,c,l,p,r[f+11],10,-1120210379),p=v(p,d,c,l,r[f+2],15,718787259),l=v(l,p,d,c,r[f+9],21,-343485551),c=c+g>>>0,l=l+R>>>0,p=p+b>>>0,d=d+T>>>0}return n.endian([c,l,p,d])})._ff=function(e,t,r,n,o,i,a){var s=e+(t&r|~t&n)+(o>>>0)+a;return(s<<i|s>>>32-i)+t},s._gg=function(e,t,r,n,o,i,a){var s=e+(t&n|r&~n)+(o>>>0)+a;return(s<<i|s>>>32-i)+t},s._hh=function(e,t,r,n,o,i,a){var s=e+(t^r^n)+(o>>>0)+a;return(s<<i|s>>>32-i)+t},s._ii=function(e,t,r,n,o,i,a){var s=e+(r^(t|~n))+(o>>>0)+a;return(s<<i|s>>>32-i)+t},s._blocksize=16,s._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var r=n.wordsToBytes(s(e,t));return t&&t.asBytes?r:t&&t.asString?a.bytesToString(r):n.bytesToHex(r)}},function(e,t){var r,n;r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var t=[],n=0;n<e.length;n+=3)for(var o=e[n]<<16|e[n+1]<<8|e[n+2],i=0;i<4;i++)8*n+6*i<=8*e.length?t.push(r.charAt(o>>>6*(3-i)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],n=0,o=0;n<e.length;o=++n%4)0!=o&&t.push((r.indexOf(e.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<2*o|r.indexOf(e.charAt(n))>>>6-2*o);return t}},e.exports=n},function(e,t){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(r(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProductInfoHelper=void 0;var n=function(){function e(){}return e.isDeviceSupported=function(e){return e.includes("set_power")},e.getCapabilityFlags=function(e){var t={brightness:!1,color:!1,colorTemperature:!1};return e.includes("set_bright")&&e.includes("adjust_bright")&&(t.brightness=!0),e.includes("set_hsv")&&(t.color=!0),e.includes("set_ct_abx")&&e.includes("adjust_ct")&&(t.colorTemperature=!0),t},e.getCapabilities=function(t){var r=[e.powerControllerCapability];return t.brightness&&r.push(e.brightnessCapability),t.color&&r.push(e.colorCapability),t.colorTemperature&&r.push(e.colorTemperatureCapability),r},e.getDisplayCategories=function(e){var t=[];return t.push("LIGHT"),t},e.powerControllerCapability={interface:"Alexa.PowerController",properties:{proactivelyReported:!1,retrievable:!0,supported:[{name:"powerState"}]},type:"AlexaInterface",version:"3"},e.colorCapability={interface:"Alexa.ColorController",properties:{proactivelyReported:!1,retrievable:!0,supported:[{name:"color"}]},type:"AlexaInterface",version:"3"},e.colorTemperatureCapability={interface:"Alexa.ColorTemperatureController",properties:{proactivelyReported:!1,retrievable:!0,supported:[{name:"colorTemperatureInKelvin"}]},type:"AlexaInterface",version:"3"},e.brightnessCapability={interface:"Alexa.BrightnessController",properties:{proactivelyReported:!1,retrievable:!0,supported:[{name:"brightness"}]},type:"AlexaInterface",version:"3"},e}();t.ProductInfoHelper=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OrchestrationBlueprintStore=void 0;var n=r(23),o=r(24),i=r(25),a=r(29),s=r(3),u=r(35),c=function(){function e(){}return e.createPowerControlCommand=function(t,r){t.commandId++;var n={id:t.commandId,method:"set_power",params:[u.UnitConverter.powerFromAlexa(r),"sudden",30]};return JSON.stringify(n)+e.delimiter},e.isPowerNotificationValid=function(e,t,r){return"string"==typeof e.power&&(e.power===r||(t.endOrchestration=!1),!0)},e.createPowerQuery=function(t){t.commandId++;var r={id:t.commandId,method:"get_prop",params:["power"]};return JSON.stringify(r)+e.delimiter},e.createCommandSeries=function(t){for(var r="",n=0,o=t;n<o.length;n++){var i=o[n];r+=JSON.stringify(i),r+=e.delimiter}return r},e.createSetBrightnessCommandSeries=function(t){t.commandId++;var r=[{id:t.commandId,method:"get_prop",params:e.deviceStateQueryParams}],n=t.executionInfo.initialResponse.brightness;return r.push({id:t.commandId,method:"set_power",params:[0===n?"off":"on","sudden",30]}),0!==n&&r.push({id:t.commandId,method:"set_bright",params:[u.UnitConverter.brightnessFromAlexa(n),"sudden",30]}),e.createCommandSeries(r)},e.createAdjustBrightnessCommandSeries=function(t){var r=Number(t.executionInfo.initialResponse.brightnessDelta);return t.commandId++,e.createCommandSeries([{id:t.commandId,method:"get_prop",params:e.deviceStateQueryParams},{id:t.commandId,method:"adjust_bright",params:[r,30]}])},e.getFinalAdjustedBrightness=function(e){var t=Number(e.executionInfo.initialResponse.brightnessDelta),r="on"===e.payload.response.result[0]?Number(e.payload.response.result[1]):0,n=u.UnitConverter.brightnessFromYeelight(r)+t;return n=(n=n<0?0:n)>100?100:n},e.createDeviceStateBrightnessResponse=function(t,r){var n=e.getDeviceStateFromResponse(t.payload.response.result);n.power=0===r?"OFF":"ON",n.brightness=r,void 0!==n.color&&(n.color.brightness=r/100);var o=e.getCapabilityFlags(t);return o.brightness=!0,s.DirectiveResponseCreator.createDeviceStateResponse(t.endpointId,n,o)},e.createColorCommandSeries=function(t){var r=t.executionInfo.initialResponse.color;return t.commandId++,e.createCommandSeries([{id:t.commandId,method:"get_prop",params:["bright"]},{id:t.commandId,method:"set_power",params:["on","sudden",30]},{id:t.commandId,method:"set_hsv",params:[u.UnitConverter.hueFromAlexa(r.hue),u.UnitConverter.saturationFromAlexa(r.saturation),"sudden",30]}])},e.createSetColorTemperatureCommandSeriesPart1=function(t){return t.commandId++,e.createCommandSeries([{id:t.commandId,method:"get_prop",params:["bright"]},{id:t.commandId,method:"set_power",params:["on","sudden",30]}])},e.createSetColorTemperatureCommandPart2=function(t){var r=Number(t.executionInfo.initialResponse.colorTemperatureInKelvin);return t.commandId++,e.createCommandSeries([{id:t.commandId,method:"set_ct_abx",params:[u.UnitConverter.colorTemperatureFromAlexa(r),"sudden",30]}])},e.createAdjustColorTemperatureCommandSeries=function(t,r){return t.commandId++,e.createCommandSeries([{id:t.commandId,method:"set_power",params:["on","sudden",30]},{id:t.commandId,method:"adjust_ct",params:[r,30]}])},e.createDeviceStateQuery=function(t){return t.commandId++,e.createCommandSeries([{id:t.commandId,method:"get_prop",params:e.deviceStateQueryParams}])},e.getDeviceStateFromResponse=function(e){var t={power:u.UnitConverter.powerFromYeelight(e[0])};return""!==e[1]&&(t.brightness=u.UnitConverter.brightnessFromYeelight(Number(e[1]))),""===e[1]||""===e[2]||""===e[3]||"1"!==e[4]&&"3"!==e[4]||(t.color={brightness:u.UnitConverter.colorBrightnessFromYeelight(Number(e[1])),hue:u.UnitConverter.hueFromYeelight(Number(e[2])),saturation:u.UnitConverter.saturationFromYeelight(Number(e[3]))}),""!==e[5]&&"2"===e[4]&&(t.colorTemperatureInKelvin=u.UnitConverter.colorTemperatureFromYeelight(Number(e[5]))),t},e.getCapabilityFlags=function(e){var t={brightness:!1,color:!1,colorTemperature:!1};return void 0!==e.cookie&&void 0!==e.cookie.productCapabilityFlags&&(t=JSON.parse(e.cookie.productCapabilityFlags)),t},e.prototype.getBlueprint=function(t){var r=t.namespace,n=t.name;if(!(r in e.DIRECTIVE_TO_BLUEPRINT_MAPPING)||!(n in e.DIRECTIVE_TO_BLUEPRINT_MAPPING[r]))return null;var o=e.DIRECTIVE_TO_BLUEPRINT_MAPPING[r][n];return{actions:o.actions.slice(),finalResponseCreator:o.finalResponseCreator}},e.className="OrchestrationBlueprintStore",e.delimiter="\r\n",e.deviceStateQueryParams=["power","bright","hue","sat","color_mode","ct"],e.colorTemperatureAdjustmentPercentage=16,e.REPORT_STATE_BLUEPRINT={actions:[new a.SendRelayRequestAction(e.createDeviceStateQuery),new i.ParseRelayResponseAction,o.ModuleErrorAction.createPropertyQueryValidator(e.deviceStateQueryParams)],finalResponseCreator:new n.FinalResponseCreator((function(t){return s.DirectiveResponseCreator.createDeviceStateResponse(t.endpointId,e.getDeviceStateFromResponse(t.payload.response.result),e.getCapabilityFlags(t))}))},e.TURN_OFF_BLUEPRINT={actions:[new a.SendRelayRequestAction((function(t){return e.createPowerControlCommand(t,"OFF")})),new i.ParseRelayResponseAction,o.ModuleErrorAction.createControlCommandValidator((function(t,r){return e.isPowerNotificationValid(t,r,"off")}),"END_ORCHESTRATION"),new a.SendRelayRequestAction((function(t){return e.createPowerQuery(t)})),new i.ParseRelayResponseAction,o.ModuleErrorAction.createPropertyStateValidator(["off"])],finalResponseCreator:new n.FinalResponseCreator((function(e){return s.DirectiveResponseCreator.createDeviceStateResponse(e.endpointId,{power:"OFF"})}))},e.TURN_ON_BLUEPRINT={actions:[new a.SendRelayRequestAction((function(t){return e.createPowerControlCommand(t,"ON")})),new i.ParseRelayResponseAction,o.ModuleErrorAction.createControlCommandValidator((function(t,r){return e.isPowerNotificationValid(t,r,"on")}),"END_ORCHESTRATION"),new a.SendRelayRequestAction((function(t){return e.createPowerQuery(t)})),new i.ParseRelayResponseAction,o.ModuleErrorAction.createPropertyStateValidator(["on"])],finalResponseCreator:new n.FinalResponseCreator((function(e){return s.DirectiveResponseCreator.createDeviceStateResponse(e.endpointId,{power:"ON"})}))},e.IDENTIFY_ENDPOINTS_BLUEPRINT={actions:[new i.ParseRelayResponseAction],finalResponseCreator:new n.FinalResponseCreator((function(e){return s.DirectiveResponseCreator.createIdentifyEndpointsResponse(e)}))},e.SET_COLOR_BLUEPRINT={actions:[new a.SendRelayRequestAction((function(t){return e.createColorCommandSeries(t)})),new i.ParseRelayResponseAction,o.ModuleErrorAction.createPropertyQueryValidator(["bright"])],finalResponseCreator:new n.FinalResponseCreator((function(t){var r=t.executionInfo.initialResponse.color,n=Number(t.payload.response.result[0]),o={power:"ON",brightness:u.UnitConverter.brightnessFromYeelight(n),color:{brightness:u.UnitConverter.colorBrightnessFromYeelight(n),hue:Number(r.hue),saturation:Number(r.saturation)}},i=e.getCapabilityFlags(t);return i.color=!0,s.DirectiveResponseCreator.createDeviceStateResponse(t.endpointId,o,i)}))},e.SET_COLOR_TEMPERATURE_BLUEPRINT={actions:[new a.SendRelayRequestAction((function(t){return e.createSetColorTemperatureCommandSeriesPart1(t)})),new i.ParseRelayResponseAction,o.ModuleErrorAction.createPropertyQueryValidator(["bright"]),new a.SendRelayRequestAction((function(t){return t.payload.savedResponse=t.payload.response,e.createSetColorTemperatureCommandPart2(t)})),new i.ParseRelayResponseAction,o.ModuleErrorAction.createControlCommandValidator((function(e,t){if("string"==typeof e.ct||"number"==typeof e.ct){var r=Number(e.ct),n=Number(t.executionInfo.initialResponse.colorTemperatureInKelvin);return console.log("set_ct_abx resulted in notification: new ct = "+r+", requested ct = "+n),r===n}return("string"==typeof e.color_mode||"number"==typeof e.color_mode)&&(console.log("set_ct_abx resulted in notification: new color_mode = "+e.color_mode),2===Number(e.color_mode))}))],finalResponseCreator:new n.FinalResponseCreator((function(t){var r=Number(t.executionInfo.initialResponse.colorTemperatureInKelvin),n=Number(t.payload.savedResponse.result[0]),o={power:"ON",brightness:u.UnitConverter.brightnessFromYeelight(n),colorTemperatureInKelvin:r},i=e.getCapabilityFlags(t);return i.colorTemperature=!0,s.DirectiveResponseCreator.createDeviceStateResponse(t.endpointId,o,i)}))},e.INCREASE_COLOR_TEMPERATURE_BLUEPRINT={actions:[new a.SendRelayRequestAction((function(t){return e.createAdjustColorTemperatureCommandSeries(t,e.colorTemperatureAdjustmentPercentage)})),new i.ParseRelayResponseAction,o.ModuleErrorAction.createControlCommandValidator((function(e,t){return"on"===e.power})),new a.SendRelayRequestAction(e.createDeviceStateQuery),new i.ParseRelayResponseAction,o.ModuleErrorAction.createPropertyQueryValidator(e.deviceStateQueryParams)],finalResponseCreator:new n.FinalResponseCreator((function(t){return s.DirectiveResponseCreator.createDeviceStateResponse(t.endpointId,e.getDeviceStateFromResponse(t.payload.response.result),e.getCapabilityFlags(t))}))},e.DECREASE_COLOR_TEMPERATURE_BLUEPRINT={actions:[new a.SendRelayRequestAction((function(t){return e.createAdjustColorTemperatureCommandSeries(t,-e.colorTemperatureAdjustmentPercentage)})),new i.ParseRelayResponseAction,o.ModuleErrorAction.createControlCommandValidator((function(e,t){return"on"===e.power})),new a.SendRelayRequestAction(e.createDeviceStateQuery),new i.ParseRelayResponseAction,o.ModuleErrorAction.createPropertyQueryValidator(e.deviceStateQueryParams)],finalResponseCreator:new n.FinalResponseCreator((function(t){return s.DirectiveResponseCreator.createDeviceStateResponse(t.endpointId,e.getDeviceStateFromResponse(t.payload.response.result),e.getCapabilityFlags(t))}))},e.SET_BRIGHTNESS_BLUEPRINT={actions:[new a.SendRelayRequestAction((function(t){return e.createSetBrightnessCommandSeries(t)})),new i.ParseRelayResponseAction,o.ModuleErrorAction.createPropertyQueryValidator(e.deviceStateQueryParams)],finalResponseCreator:new n.FinalResponseCreator((function(t){return e.createDeviceStateBrightnessResponse(t,Number(t.executionInfo.initialResponse.brightness))}))},e.ADJUST_BRIGHTNESS_BLUEPRINT={actions:[new a.SendRelayRequestAction((function(t){return e.createAdjustBrightnessCommandSeries(t)})),new i.ParseRelayResponseAction,o.ModuleErrorAction.createPropertyQueryValidator(e.deviceStateQueryParams)],finalResponseCreator:new n.FinalResponseCreator((function(t){return e.createDeviceStateBrightnessResponse(t,e.getFinalAdjustedBrightness(t))}))},e.DIRECTIVE_TO_BLUEPRINT_MAPPING={Alexa:{ReportState:e.REPORT_STATE_BLUEPRINT},"Alexa.BrightnessController":{AdjustBrightness:e.ADJUST_BRIGHTNESS_BLUEPRINT,SetBrightness:e.SET_BRIGHTNESS_BLUEPRINT},"Alexa.ColorController":{SetColor:e.SET_COLOR_BLUEPRINT},"Alexa.ColorTemperatureController":{SetColorTemperature:e.SET_COLOR_TEMPERATURE_BLUEPRINT,IncreaseColorTemperature:e.INCREASE_COLOR_TEMPERATURE_BLUEPRINT,DecreaseColorTemperature:e.DECREASE_COLOR_TEMPERATURE_BLUEPRINT},"Alexa.Discovery":{IdentifyEndpoints:e.IDENTIFY_ENDPOINTS_BLUEPRINT},"Alexa.PowerController":{TurnOff:e.TURN_OFF_BLUEPRINT,TurnOn:e.TURN_ON_BLUEPRINT}},e}();t.OrchestrationBlueprintStore=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FinalResponseCreator=void 0;var n=function(){function e(e){this.responseTemplateFunc=e}return e.prototype.createResponse=function(e,t,r){var n=this.responseTemplateFunc(e),o=n.event.header;return"Alexa"===o.namespace&&"ErrorResponse"===o.name?r(n):t(n)},e}();t.FinalResponseCreator=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleErrorAction=void 0;var n=function(){function e(e,t,r,n){void 0===r&&(r=!1),this.mode=e,this.params=t,this.endOrchestration=r,this.isNotificationValid=n}return e.createControlCommandValidator=function(t,r){return void 0===r&&(r=""),new e("COMMAND",[],"END_ORCHESTRATION"===r,t)},e.createPropertyQueryValidator=function(t){return new e("QUERY",t)},e.createPropertyStateValidator=function(t){return new e("STATE",t)},e.logError=function(t,r){return console.error(e.className+":: Wrong response message: "+JSON.stringify(r)),t({message:"Encountered error message.",type:"INTERNAL_ERROR"})},e.isValueValidForProperty=function(t,r){if(""===r){switch(t){case"bright":case"ct":case"color_mode":case"hue":case"sat":case"name":return!0}return!1}switch(t){case"power":return"on"===r||"off"===r;case"bright":return e.isInRange(Number(r),1,100);case"ct":return e.isInRange(Number(r),1e3,1e4);case"color_mode":return e.isInRange(Number(r),1,3);case"hue":return e.isInRange(Number(r),0,359);case"sat":return e.isInRange(Number(r),0,100);case"name":return!0}return console.error(e.className+":: Unsupported property: "+t),!1},e.isInRange=function(e,t,r){return e>=t&&e<=r},e.prototype.perform=function(t,r,n){this.endOrchestration&&(t.endOrchestration=!0);var o=t.payload.response;return console.debug(e.className+":: Checking for errors in "+this.mode+" mode for message id "+t.commandId+" from the following response: "+JSON.stringify(o)),null==o||"error"in o?e.logError(n,o):o.result?o.id!==t.commandId?(console.error(e.className+":: Expected message id "+t.commandId+", received "+o.id),e.logError(n,o)):this.validateResult(o.result)?r():e.logError(n,o):"COMMAND"===this.mode&&"props"===o.method&&o.params&&void 0!==this.isNotificationValid&&this.isNotificationValid(o.params,t)?r():e.logError(n,o)},e.prototype.validateResult=function(e){switch(this.mode){case"COMMAND":return"ok"===e[0];case"QUERY":return this.validateQueryResult(e);case"STATE":return this.validateStateResult(e)}},e.prototype.validateQueryResult=function(t){if(!this.validateResultLength(t))return this.logParamsError("Properties");for(var r=0;r<t.length;r++)if(!e.isValueValidForProperty(this.params[r],t[r]))return this.logParamsError("Properties",r,t);return!0},e.prototype.validateStateResult=function(e){if(!this.validateResultLength(e))return this.logParamsError("Values");for(var t=0;t<e.length;t++)if(this.params[t]!==e[t])return this.logParamsError("Values",t,e);return!0},e.prototype.validateResultLength=function(e){return e.length===this.params.length||this.logResultLengthError(e)},e.prototype.logResultLengthError=function(t){return console.error(e.className+":: Expected "+this.params.length+" result values, received "+t.length),!1},e.prototype.logParamsError=function(t,r,n){return void 0===n&&(n=[]),console.error(e.className+":: "+t+" expected: "+JSON.stringify(this.params)),void 0!==r&&console.error(e.className+":: Mismatch at ["+r+']: "'+this.params[r]+'", "'+n[r]+'"'),!1},e.className="ModuleErrorAction",e}();t.ModuleErrorAction=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParseRelayResponseAction=void 0;var n=r(8),o=r(9),i=function(){function e(){}return e.prototype.perform=function(e,t,r){var i,a=n.Base64Util.dec(e.payload.base64Response);i=(new o.TextWrapper.TEXT_DECODER_TYPE).decode(a);try{e.payload.response=JSON.parse(i)}catch(e){var s="Unable to parse device response message";return console.log(e),console.error(s+", Message: "+i),r({message:s,type:"INTERNAL_ERROR"})}return t()},e.className="ParseRelayResponseAction",e}();t.ParseRelayResponseAction=i},function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var u,c=[],l=!1,p=-1;function d(){l&&u&&(l=!1,u.length?c=u.concat(c):p=-1,c.length&&f())}function f(){if(!l){var e=s(d);l=!0;for(var t=c.length;t;){for(u=c,c=[];++p<t;)u&&u[p].run();p=-1,t=c.length}u=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function y(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new m(e,t)),1!==c.length||l||s(f)},m.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SendRelayRequestAction=void 0;var n=r(30),o=r(2),i=r(8),a=r(9),s=function(){function e(e){this.payloadTemplateFunc=e}return e.prototype.perform=function(t,r,o){var s=this.payloadTemplateFunc(t);console.debug(e.className+":: request payload: "+s);var u=(new a.TextWrapper.TEXT_ENCODER_TYPE).encode(s),c=i.Base64Util.enc(u),l=this.createRelayDirective(t.endpointId,{base64Request:c,responseReadStrategy:{name:"ResponseDelimiter",delimiter:e.delimiter}}),p=new n.RelayData.TCPRequestContext({directive:l},(function(n){return console.debug(e.className+":: Received relay response event: "+JSON.stringify(n)),t.payload.base64Response=n.event.payload.base64Response,r()}),(function(t){return console.error(e.className+":: Encountered TCP error response: "+JSON.stringify(t)),o({message:t.event.payload.message,type:t.event.payload.type})}));console.debug(e.className+":: Relaying intermediate request directive: "+JSON.stringify(l)),t.requestRelay.relay(p)},e.prototype.createRelayDirective=function(e,t){return{endpoint:{endpointId:e},header:{messageId:o.v4(),name:"SendRequest",namespace:"Alexa.TcpController",payloadVersion:"3"},payload:t}},e.className="SendRelayRequestAction",e.delimiter="\r\n",e}();t.SendRelayRequestAction=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(31);t.AlexaAPI=n;var o=r(4);t.RelayData=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(32);t.Capabilities=n;var o=r(33);t.Discovery=o;var i=r(34);t.LocalCapabilities=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnitConverter=void 0;var n=function(){function e(){}return e.brightnessFromYeelight=function(e){return e},e.brightnessFromAlexa=function(e){var t=Math.round(e);return t>0?t:1},e.colorBrightnessFromYeelight=function(e){return e/100},e.colorBrightnessFromAlexa=function(e){var t=Math.round(100*e);return t>0?t:1},e.hueFromYeelight=function(e){return e},e.hueFromAlexa=function(e){return Math.round(e)%360},e.saturationFromYeelight=function(e){return e/100},e.saturationFromAlexa=function(e){return Math.round(100*e)},e.colorTemperatureFromYeelight=function(e){return e},e.colorTemperatureFromAlexa=function(e){return e},e.powerFromYeelight=function(e){return"off"===e.toLowerCase()?"OFF":"ON"},e.powerFromAlexa=function(e){return"ON"===e.toUpperCase()?"on":"off"},e}();t.UnitConverter=n}]);