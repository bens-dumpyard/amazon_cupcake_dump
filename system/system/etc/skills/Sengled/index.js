/*! For license information please see index.js.LICENSE.txt */
var Skill=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=9)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=function(){function e(e,t,r,o){this.requestId=n.v4(),this.requestMessage=e,this.transportProtocol=t,this.onSuccess=r,this.onFailure=o}return e.prototype.getRequestId=function(){return this.requestId},e.prototype.getTransportProtocol=function(){return this.transportProtocol},e.prototype.getRequestMessage=function(){return this.requestMessage},e.prototype.onSuccess=function(e){return this.onSuccessCallback(e)},e.prototype.onFailure=function(e){return this.onFailureCallback(e)},e}();t.RequestContext=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.RAW_TCP=0]="RAW_TCP",e[e.RAW_UDP=1]="RAW_UDP",e[e.HTTP=2]="HTTP"}(t.TransportProtocol||(t.TransportProtocol={}))},function(e,t,r){var n=r(11),o=r(12),s=o;s.v1=n,s.v4=o,e.exports=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DirectiveResponseCreator=void 0;var n=r(16),o=r(2),s=r(4),i=function(){function e(){}return e.createResponse=function(e,t){return{context:t,event:{endpoint:{endpointId:e},header:{messageId:o.v4(),name:"Response",namespace:"Alexa",payloadVersion:"3"},payload:{}}}},e.createErrorResponse=function(e,t,r){return void 0===r&&(r=""),{event:{endpoint:{endpointId:r},header:{messageId:o.v4(),name:"ErrorResponse",namespace:"Alexa",payloadVersion:"3"},payload:{message:t,type:e}}}},e.createInternalErrorResponse=function(t,r){void 0===r&&(r="");var n=e.className+":: "+t;return console.debug(n),e.createErrorResponse("INTERNAL_ERROR",t,r)},e.createIdentifyEndpointsResponse=function(t){var r=t.payload.initialDirectivePayload.data.dnsTxt,i=null,a=null;if(r){for(var c=0,u=Object.keys(r);c<u.length;c++){var l=u[c],p=r[l];""===p?i=l:r[l.toLowerCase()]=s.Base64Util.decodeString(p)}a=r.model}if(null==a||""===a)return e.createInternalErrorResponse("dnsTxt.model not received");var f=t.executionInfo.responseData.macAddress;void 0===f?console.log("Query for MAC address failed, using address from dnsTxt"):(i=f,console.log("DirectiveResponseCreator:: Using MAC address from device response")),null!==i&&(i=i.toUpperCase());var d=e.manufacturerName,v=!1,y="",R=[],h=[];switch(a){case"W21-N13":h.push(this.colorCapability);case"W21-N11":case"W21-N11DL":v=!0,y=d+" Wi-Fi Smart Bulb",R.push("LIGHT"),h.push(this.brightnessCapability),h.push(this.powerControllerCapability)}if(!v)return e.createInternalErrorResponse("dnsTxt.model product type not supported");var g=r["firmware rev"],_=e.getSoftwareVersion(t),m={event:{header:{messageId:o.v4(),name:"Discover.Response",namespace:"Alexa.Discovery",payloadVersion:"3"},payload:{endpoints:[{additionalAttributes:{firmwareVersion:g,model:a,serialNumber:i,softwareVersion:_},capabilities:h,connections:[{macAddress:i,type:"UDP_IP"}],description:y,displayCategories:R,endpointId:n(e.SKILL_NAME+i),friendlyName:"default"+parseInt(n(i).slice(-8),16)%1e6,manufacturerName:d}]}}};return console.debug("DirectiveResponseCreator:: IdentifyEndpoints Response: "+JSON.stringify(m)),m},e.getSoftwareVersion=function(e){var t="",r=e.executionInfo.responseData.softwareVersion;if("string"==typeof r){var n=(r=r.toLowerCase()).match(/v\d*\.\d*/);null!==n&&"string"==typeof n[0]&&(t=n[0])}return console.debug('DirectiveResponseCreator:: software version "'+t+'" parsed from "'+r+'"'),t},e.className="DirectiveResponseCreator",e.SKILL_NAME="SENGLED",e.manufacturerName="Sengled",e.powerControllerCapability={interface:"Alexa.PowerController",properties:{proactivelyReported:!1,retrievable:!1,supported:[{name:"powerState"}]},type:"AlexaInterface",version:"3"},e.brightnessCapability={interface:"Alexa.BrightnessController",properties:{proactivelyReported:!1,retrievable:!1,supported:[{name:"brightness"}]},type:"AlexaInterface",version:"3"},e.colorCapability={interface:"Alexa.ColorController",properties:{proactivelyReported:!1,retrievable:!1,supported:[{name:"color"}]},type:"AlexaInterface",version:"3"},e}();t.DirectiveResponseCreator=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Base64Util=void 0;var n=function(){function e(){}return e.enc=function(e){return"undefined"!=typeof Base64?Base64.encode(e):new Buffer(e).toString("base64")},e.dec=function(e){return"undefined"!=typeof Base64?Base64.decode(e):new Uint8Array(new Buffer(e,"base64"))},e.encodeString=function(e){return this.enc((new TextEncoder).encode(e))},e.decodeString=function(e){return(new TextDecoder).decode(this.dec(e))},e}();t.Base64Util=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10);t.HttpRequestContext=n.HttpRequestContext;var o=r(0);t.RequestContext=o.RequestContext;var s=r(13);t.TCPRequestContext=s.TCPRequestContext;var i=r(1);t.TransportProtocol=i.TransportProtocol;var a=r(14);t.UDPRequestContext=a.UDPRequestContext},function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);e.exports=function(){return r(n),n}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,o=r;return[o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]]].join("")}},function(e,t){var r={utf8:{stringToBytes:function(e){return r.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(r.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}};e.exports=r},function(e,t,r){"use strict";var n=r(5),o=r(15),s=r(3),i=r(19),a=function(){function e(e,t){this.blueprintStore=e,this.actionOrchestrator=t,null==e&&(this.blueprintStore=new i.OrchestrationBlueprintStore),null==t&&(this.actionOrchestrator=new o.ActionOrchestrator)}return e.prototype.executeDirective=function(t,r,o,i){console.debug(e.className+":: Executing directive: "+JSON.stringify(t));var a=t.directive,c="",u={};if(void 0!==a.endpoint&&(c=a.endpoint.endpointId,u=a.endpoint.cookie),!r.isSupportedTransportProtocol(n.TransportProtocol.RAW_UDP)){var l=e.className+" requires UDP relay support to work!";return console.error(l),i(s.DirectiveResponseCreator.createErrorResponse("INTERNAL_ERROR",l,c))}var p=a.header.namespace,f=a.header.name,d=this.blueprintStore.getBlueprint(a.header);if(null===d){l=e.className+":: Directive with namespace: "+p+" and name: "+f+" not supported!";return console.error(l),i(s.DirectiveResponseCreator.createErrorResponse("INVALID_DIRECTIVE",l,c))}return this.actionOrchestrator.orchestrateAction(d,{cookie:u,endpointId:c,executionInfo:{responseData:{}},payload:{initialDirectivePayload:a.payload},requestRelay:r},o,i)},e.className="SengledSkill",e}();e.exports=a},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s=r(0),i=r(1),a=function(e){function t(t,r,n){return e.call(this,t,i.TransportProtocol.HTTP,r,n)||this}return o(t,e),t}(s.RequestContext);t.HttpRequestContext=a},function(e,t,r){var n,o,s=r(6),i=r(7),a=0,c=0;e.exports=function(e,t,r){var u=t&&r||0,l=t||[],p=(e=e||{}).node||n,f=void 0!==e.clockseq?e.clockseq:o;if(null==p||null==f){var d=s();null==p&&(p=n=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==f&&(f=o=16383&(d[6]<<8|d[7]))}var v=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:c+1,R=v-a+(y-c)/1e4;if(R<0&&void 0===e.clockseq&&(f=f+1&16383),(R<0||v>a)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=v,c=y,o=f;var h=(1e4*(268435455&(v+=122192928e5))+y)%4294967296;l[u++]=h>>>24&255,l[u++]=h>>>16&255,l[u++]=h>>>8&255,l[u++]=255&h;var g=v/4294967296*1e4&268435455;l[u++]=g>>>8&255,l[u++]=255&g,l[u++]=g>>>24&15|16,l[u++]=g>>>16&255,l[u++]=f>>>8|128,l[u++]=255&f;for(var _=0;_<6;++_)l[u+_]=p[_];return t||i(l)}},function(e,t,r){var n=r(6),o=r(7);e.exports=function(e,t,r){var s=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||n)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var a=0;a<16;++a)t[s+a]=i[a];return t||o(i)}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s=r(0),i=r(1),a=function(e){function t(t,r,n){return e.call(this,t,i.TransportProtocol.RAW_TCP,r,n)||this}return o(t,e),t}(s.RequestContext);t.TCPRequestContext=a},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var s=r(0),i=r(1),a=function(e){function t(t,r,n){return e.call(this,t,i.TransportProtocol.RAW_UDP,r,n)||this}return o(t,e),t}(s.RequestContext);t.UDPRequestContext=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionOrchestrator=void 0;var n=r(3),o=function(){function e(){}return e.prototype.orchestrateAction=function(e,t,r,o){var s=this;if(e.actions.length<1)return e.finalResponseCreator.createResponse(t,r,o);e.actions.shift().perform(t,(function(){return s.orchestrateAction(e,t,r,o)}),(function(e){return o(n.DirectiveResponseCreator.createErrorResponse(e.type,e.message,t.endpointId))}))},e}();t.ActionOrchestrator=o},function(e,t,r){var n,o,s,i,a;n=r(17),o=r(8).utf8,s=r(18),i=r(8).bin,(a=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?i.stringToBytes(e):o.stringToBytes(e):s(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||e.constructor===Uint8Array||(e=e.toString());for(var r=n.bytesToWords(e),c=8*e.length,u=1732584193,l=-271733879,p=-1732584194,f=271733878,d=0;d<r.length;d++)r[d]=16711935&(r[d]<<8|r[d]>>>24)|4278255360&(r[d]<<24|r[d]>>>8);r[c>>>5]|=128<<c%32,r[14+(c+64>>>9<<4)]=c;var v=a._ff,y=a._gg,R=a._hh,h=a._ii;for(d=0;d<r.length;d+=16){var g=u,_=l,m=p,b=f;u=v(u,l,p,f,r[d+0],7,-680876936),f=v(f,u,l,p,r[d+1],12,-389564586),p=v(p,f,u,l,r[d+2],17,606105819),l=v(l,p,f,u,r[d+3],22,-1044525330),u=v(u,l,p,f,r[d+4],7,-176418897),f=v(f,u,l,p,r[d+5],12,1200080426),p=v(p,f,u,l,r[d+6],17,-1473231341),l=v(l,p,f,u,r[d+7],22,-45705983),u=v(u,l,p,f,r[d+8],7,1770035416),f=v(f,u,l,p,r[d+9],12,-1958414417),p=v(p,f,u,l,r[d+10],17,-42063),l=v(l,p,f,u,r[d+11],22,-1990404162),u=v(u,l,p,f,r[d+12],7,1804603682),f=v(f,u,l,p,r[d+13],12,-40341101),p=v(p,f,u,l,r[d+14],17,-1502002290),u=y(u,l=v(l,p,f,u,r[d+15],22,1236535329),p,f,r[d+1],5,-165796510),f=y(f,u,l,p,r[d+6],9,-1069501632),p=y(p,f,u,l,r[d+11],14,643717713),l=y(l,p,f,u,r[d+0],20,-373897302),u=y(u,l,p,f,r[d+5],5,-701558691),f=y(f,u,l,p,r[d+10],9,38016083),p=y(p,f,u,l,r[d+15],14,-660478335),l=y(l,p,f,u,r[d+4],20,-405537848),u=y(u,l,p,f,r[d+9],5,568446438),f=y(f,u,l,p,r[d+14],9,-1019803690),p=y(p,f,u,l,r[d+3],14,-187363961),l=y(l,p,f,u,r[d+8],20,1163531501),u=y(u,l,p,f,r[d+13],5,-1444681467),f=y(f,u,l,p,r[d+2],9,-51403784),p=y(p,f,u,l,r[d+7],14,1735328473),u=R(u,l=y(l,p,f,u,r[d+12],20,-1926607734),p,f,r[d+5],4,-378558),f=R(f,u,l,p,r[d+8],11,-2022574463),p=R(p,f,u,l,r[d+11],16,1839030562),l=R(l,p,f,u,r[d+14],23,-35309556),u=R(u,l,p,f,r[d+1],4,-1530992060),f=R(f,u,l,p,r[d+4],11,1272893353),p=R(p,f,u,l,r[d+7],16,-155497632),l=R(l,p,f,u,r[d+10],23,-1094730640),u=R(u,l,p,f,r[d+13],4,681279174),f=R(f,u,l,p,r[d+0],11,-358537222),p=R(p,f,u,l,r[d+3],16,-722521979),l=R(l,p,f,u,r[d+6],23,76029189),u=R(u,l,p,f,r[d+9],4,-640364487),f=R(f,u,l,p,r[d+12],11,-421815835),p=R(p,f,u,l,r[d+15],16,530742520),u=h(u,l=R(l,p,f,u,r[d+2],23,-995338651),p,f,r[d+0],6,-198630844),f=h(f,u,l,p,r[d+7],10,1126891415),p=h(p,f,u,l,r[d+14],15,-1416354905),l=h(l,p,f,u,r[d+5],21,-57434055),u=h(u,l,p,f,r[d+12],6,1700485571),f=h(f,u,l,p,r[d+3],10,-1894986606),p=h(p,f,u,l,r[d+10],15,-1051523),l=h(l,p,f,u,r[d+1],21,-2054922799),u=h(u,l,p,f,r[d+8],6,1873313359),f=h(f,u,l,p,r[d+15],10,-30611744),p=h(p,f,u,l,r[d+6],15,-1560198380),l=h(l,p,f,u,r[d+13],21,1309151649),u=h(u,l,p,f,r[d+4],6,-145523070),f=h(f,u,l,p,r[d+11],10,-1120210379),p=h(p,f,u,l,r[d+2],15,718787259),l=h(l,p,f,u,r[d+9],21,-343485551),u=u+g>>>0,l=l+_>>>0,p=p+m>>>0,f=f+b>>>0}return n.endian([u,l,p,f])})._ff=function(e,t,r,n,o,s,i){var a=e+(t&r|~t&n)+(o>>>0)+i;return(a<<s|a>>>32-s)+t},a._gg=function(e,t,r,n,o,s,i){var a=e+(t&n|r&~n)+(o>>>0)+i;return(a<<s|a>>>32-s)+t},a._hh=function(e,t,r,n,o,s,i){var a=e+(t^r^n)+(o>>>0)+i;return(a<<s|a>>>32-s)+t},a._ii=function(e,t,r,n,o,s,i){var a=e+(r^(t|~n))+(o>>>0)+i;return(a<<s|a>>>32-s)+t},a._blocksize=16,a._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var r=n.wordsToBytes(a(e,t));return t&&t.asBytes?r:t&&t.asString?i.bytesToString(r):n.bytesToHex(r)}},function(e,t){var r,n;r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var t=[],n=0;n<e.length;n+=3)for(var o=e[n]<<16|e[n+1]<<8|e[n+2],s=0;s<4;s++)8*n+6*s<=8*e.length?t.push(r.charAt(o>>>6*(3-s)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],n=0,o=0;n<e.length;o=++n%4)0!=o&&t.push((r.indexOf(e.charAt(n-1))&Math.pow(2,-2*o+8)-1)<<2*o|r.indexOf(e.charAt(n))>>>6-2*o);return t}},e.exports=n},function(e,t){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(r(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OrchestrationBlueprintStore=void 0;var n=r(20),o=r(21),s=r(23),i=r(24),a=r(3),c=r(30),u=r(31),l=function(){function e(){}return e.createDeviceMacQuery=function(){return JSON.stringify({func:"get_device_mac"})},e.createSoftwareVersionQuery=function(){return JSON.stringify({func:"get_software_version"})},e.createPowerControlCommand=function(e){var t={func:"set_device_switch",param:{switch:e}};return JSON.stringify(t)},e.createSetDeviceColorCommand=function(e){var t=u.HSVToRGBColorTransformer.convert(e.payload.initialDirectivePayload.color),r={func:"set_device_color",param:{blue:t.blue,green:t.green,red:t.red}};return JSON.stringify(r)},e.createGetDeviceBrightnessQuery=function(){return JSON.stringify({func:"get_device_brightness"})},e.createSetDeviceBrightnessCommand=function(e){var t={func:"set_device_brightness",param:{brightness:e=c.BrightnessConverter.fromAlexa(e)}};return JSON.stringify(t)},e.getAdjustedBrightness=function(e){var t=c.BrightnessConverter.fromDevice(e.executionInfo.responseData.brightness),r=e.payload.initialDirectivePayload.brightnessDelta;return c.BrightnessConverter.adjustAlexaBrightness(t,r)},e.prototype.getBlueprint=function(t){var r=t.namespace,n=t.name;if(!(r in e.DIRECTIVE_TO_BLUEPRINT_MAPPING)||!(n in e.DIRECTIVE_TO_BLUEPRINT_MAPPING[r]))return null;var o=e.DIRECTIVE_TO_BLUEPRINT_MAPPING[r][n];return{actions:o.actions.slice(),finalResponseCreator:o.finalResponseCreator}},e.className="OrchestrationBlueprintStore",e.IDENTIFY_ENDPOINTS_BLUEPRINT={actions:[new i.SendRelayRequestAction((function(t){return e.createDeviceMacQuery()})),new s.ParseRelayResponseAction,new o.ModuleErrorAction("get_device_mac"),new i.SendRelayRequestAction((function(t){return e.createSoftwareVersionQuery()})),new s.ParseRelayResponseAction,new o.ModuleErrorAction("get_software_version",!0)],finalResponseCreator:new n.FinalResponseCreator((function(e){return a.DirectiveResponseCreator.createIdentifyEndpointsResponse(e)}))},e.TURN_ON_BLUEPRINT={actions:[new i.SendRelayRequestAction((function(t){return e.createPowerControlCommand(1)})),new s.ParseRelayResponseAction,new o.ModuleErrorAction("set_device_switch")],finalResponseCreator:new n.FinalResponseCreator((function(e){return a.DirectiveResponseCreator.createResponse(e.endpointId,{properties:[{name:"powerState",namespace:"Alexa.PowerController",timeOfSample:(new Date).toUTCString(),uncertaintyInMilliseconds:0,value:"ON"}]})}))},e.TURN_OFF_BLUEPRINT={actions:[new i.SendRelayRequestAction((function(t){return e.createPowerControlCommand(0)})),new s.ParseRelayResponseAction,new o.ModuleErrorAction("set_device_switch")],finalResponseCreator:new n.FinalResponseCreator((function(e){return a.DirectiveResponseCreator.createResponse(e.endpointId,{properties:[{name:"powerState",namespace:"Alexa.PowerController",timeOfSample:(new Date).toUTCString(),uncertaintyInMilliseconds:0,value:"OFF"}]})}))},e.REPORT_STATE_BLUEPRINT={actions:[new i.SendRelayRequestAction((function(t){return e.createDeviceMacQuery()})),new s.ParseRelayResponseAction,new o.ModuleErrorAction("get_device_mac")],finalResponseCreator:new n.FinalResponseCreator((function(e){return a.DirectiveResponseCreator.createResponse(e.endpointId,{properties:[]})}))},e.SET_COLOR_BLUEPRINT={actions:[new i.SendRelayRequestAction((function(t){return e.createSetDeviceColorCommand(t)})),new s.ParseRelayResponseAction,new o.ModuleErrorAction("set_device_color")],finalResponseCreator:new n.FinalResponseCreator((function(e){var t=e.payload.initialDirectivePayload.color;return a.DirectiveResponseCreator.createResponse(e.endpointId,{properties:[{name:"color",namespace:"Alexa.ColorController",timeOfSample:(new Date).toUTCString(),uncertaintyInMilliseconds:0,value:{brightness:Number(t.brightness),hue:Number(t.hue),saturation:Number(t.saturation)}}]})}))},e.SET_BRIGHTNESS_BLUEPRINT={actions:[new i.SendRelayRequestAction((function(t){return e.createSetDeviceBrightnessCommand(t.payload.initialDirectivePayload.brightness)})),new s.ParseRelayResponseAction,new o.ModuleErrorAction("set_device_brightness")],finalResponseCreator:new n.FinalResponseCreator((function(e){return a.DirectiveResponseCreator.createResponse(e.endpointId,{properties:[{name:"brightness",namespace:"Alexa.BrightnessController",timeOfSample:(new Date).toUTCString(),uncertaintyInMilliseconds:0,value:Number(e.payload.initialDirectivePayload.brightness)}]})}))},e.ADJUST_BRIGHTNESS_BLUEPRINT={actions:[new i.SendRelayRequestAction((function(t){return e.createGetDeviceBrightnessQuery()})),new s.ParseRelayResponseAction,new o.ModuleErrorAction("get_device_brightness"),new i.SendRelayRequestAction((function(t){return t.payload.adjustedBrightness=e.getAdjustedBrightness(t),e.createSetDeviceBrightnessCommand(t.payload.adjustedBrightness)})),new s.ParseRelayResponseAction,new o.ModuleErrorAction("set_device_brightness")],finalResponseCreator:new n.FinalResponseCreator((function(e){return a.DirectiveResponseCreator.createResponse(e.endpointId,{properties:[{name:"brightness",namespace:"Alexa.BrightnessController",timeOfSample:(new Date).toUTCString(),uncertaintyInMilliseconds:0,value:e.payload.adjustedBrightness}]})}))},e.DIRECTIVE_TO_BLUEPRINT_MAPPING={Alexa:{ReportState:e.REPORT_STATE_BLUEPRINT},"Alexa.BrightnessController":{AdjustBrightness:e.ADJUST_BRIGHTNESS_BLUEPRINT,SetBrightness:e.SET_BRIGHTNESS_BLUEPRINT},"Alexa.ColorController":{SetColor:e.SET_COLOR_BLUEPRINT},"Alexa.Discovery":{IdentifyEndpoints:e.IDENTIFY_ENDPOINTS_BLUEPRINT},"Alexa.PowerController":{TurnOff:e.TURN_OFF_BLUEPRINT,TurnOn:e.TURN_ON_BLUEPRINT}},e}();t.OrchestrationBlueprintStore=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FinalResponseCreator=void 0;var n=function(){function e(e){this.responseTemplateFunc=e}return e.prototype.createResponse=function(e,t,r){var n=this.responseTemplateFunc(e),o=n.event.header;return"Alexa"===o.namespace&&"ErrorResponse"===o.name?r(n):t(n)},e}();t.FinalResponseCreator=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ModuleErrorAction=void 0;var n=r(22),o=function(){function e(e,t){void 0===t&&(t=!1),this.expectedFunc=e,this.softFail=t}return e.prototype.perform=function(t,r,o){var s=this,i=t.payload.response;this.response=i,this.onSuccess=r,this.onFailure=o,console.debug(e.className+":: Checking for errors from the following response: "+JSON.stringify(i)),(new n.MessageParser).parseDeviceResponse(i,this.expectedFunc,t.executionInfo.responseData,(function(){r()}),(function(e){s.onParseFailure(e)}))},e.prototype.onParseFailure=function(t){return console.error(e.className+":: Wrong response message: "+JSON.stringify(this.response)),this.softFail?this.onSuccess():this.onFailure({message:t,type:"INTERNAL_ERROR"})},e.className="ModuleErrorAction",e}();t.ModuleErrorAction=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageParser=void 0;var n=function(){function e(){}return e.prototype.parseDeviceResponse=function(e,t,r,n,o){if(this.onFailure=o,this.responseData=r,this.validateMessageIsObject(e)&&this.validateMessageFunc(e,t)&&this.validateMessageHasResult(e)&&this.validateMessageRetIsSuccess(e))return this.parseResultData(e)?n():void 0},e.prototype.validateMessageIsObject=function(t){return null===t?this.onError(e.ERR_NO_RESPONSE,"msg parameter is null"):void 0===t?this.onError(e.ERR_NO_RESPONSE,"msg parameter is undefined"):"object"==typeof t||this.onError(e.ERR_MALFORMED,'msg parameter type is "'+typeof t+'", expected "object"')},e.prototype.validateMessageFunc=function(t,r){if("string"!=typeof t.func)return this.onError(e.ERR_MALFORMED,'msg.func type is "'+typeof t.func+'", expected "string"');var n=r.toLowerCase(),o=t.func.toLowerCase();return o===n||this.onError(e.ERR_MISMATCH,'msg.func "'+o+'", expected "'+n+'"')},e.prototype.validateMessageHasResult=function(t){return null===t.result?this.onError(e.ERR_MALFORMED,"msg.result is null"):"object"==typeof t.result||this.onError(e.ERR_MALFORMED,'msg.result type is "'+typeof t.result+'", expected "object"')},e.prototype.validateMessageRetIsSuccess=function(t){return"number"!=typeof t.result.ret?this.onError(e.ERR_MALFORMED,'msg.result.ret type is "'+typeof t.result.ret+'", expected "number"'):0===t.result.ret||this.onError(e.ERR_DEVICE,"msg.result .ret = "+t.result.ret+', .msg = "'+t.result.msg+'"')},e.prototype.parseResultData=function(t){var r=t.func.toLowerCase();switch(r){case"set_device_switch":case"set_device_brightness":case"set_device_color_temperature":case"set_device_color":return!0;case"get_device_brightness":return this.parseDeviceBrightness(t);case"get_device_mac":return this.parseDeviceMac(t);case"get_software_version":return this.parseSoftwareVersion(t)}return this.onError(e.ERR_UNKNOWN_FUNC,'unrecognized func name "'+r+'"')},e.prototype.parseDeviceBrightness=function(t){return"number"==typeof t.result.brightness?(this.responseData.brightness=t.result.brightness,!0):this.onError(e.ERR_MISSING_FIELD,'msg.result.brightness type "'+typeof t.result.brightness+'", expected "number"')},e.prototype.parseDeviceMac=function(t){return"string"==typeof t.result.mac?(this.responseData.macAddress=t.result.mac,!0):this.onError(e.ERR_MISSING_FIELD,'msg.result.mac type "'+typeof t.result.mac+'", expected "string"')},e.prototype.parseSoftwareVersion=function(t){return"string"==typeof t.result.version?(this.responseData.softwareVersion=t.result.version,!0):this.onError(e.ERR_MISSING_FIELD,'msg.result.version type "'+typeof t.result.version+'", expected "string"')},e.prototype.onError=function(e,t){var r="MessageParser::parseDeviceResponse(): "+e+" ("+t+")";return console.error(r),this.onFailure(r),!1},e.ERR_NO_RESPONSE="No device response message",e.ERR_MISMATCH="Device response does not match request",e.ERR_MALFORMED="Unable to parse device response",e.ERR_DEVICE="The device returned an error response",e.ERR_MISSING_FIELD="An expected field is missing from the device response",e.ERR_UNKNOWN_FUNC="Message function name not recognized",e}();t.MessageParser=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ParseRelayResponseAction=void 0;var n=r(4),o=function(){function e(){}return e.prototype.perform=function(e,t,r){var o=n.Base64Util.decodeString(e.payload.base64Response);try{e.payload.response=JSON.parse(o)}catch(e){var s="Unable to parse device response message";return console.log(e),console.error(s+", Message: "+o),r({message:s,type:"INTERNAL_ERROR"})}return t()},e}();t.ParseRelayResponseAction=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SendRelayRequestAction=void 0;var n=r(25),o=r(2),s=r(4),i=function(){function e(e){this.payloadTemplateFunc=e}return e.prototype.perform=function(t,r,o){var i=this.payloadTemplateFunc(t);console.debug(e.className+":: request payload: "+i);var a=s.Base64Util.encodeString(i),c=this.createRelayDirective(t.endpointId,{base64Request:a}),u=new n.RelayData.UDPRequestContext({directive:c},(function(n){return console.debug(e.className+":: Received relay response event: "+JSON.stringify(n)),t.payload.base64Response=n.event.payload.base64Response,r()}),(function(t){return console.error(e.className+":: Encountered UDP error response: "+JSON.stringify(t)),o({message:t.event.payload.message,type:t.event.payload.type})}));console.debug(e.className+":: Relaying intermediate request directive: "+JSON.stringify(c)),t.requestRelay.relay(u)},e.prototype.createRelayDirective=function(e,t){return{endpoint:{endpointId:e},header:{messageId:o.v4(),name:"SendRequest",namespace:"Alexa.UdpController",payloadVersion:"3"},payload:t}},e.className="SendRelayRequestAction",e}();t.SendRelayRequestAction=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(26);t.AlexaAPI=n;var o=r(5);t.RelayData=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(27);t.Capabilities=n;var o=r(28);t.Discovery=o;var s=r(29);t.LocalCapabilities=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BrightnessConverter=void 0;var n=function(){function e(){}return e.fromAlexa=function(e){return e},e.fromDevice=function(e){return e},e.adjustAlexaBrightness=function(e,t){var r=e+t;return r<1&&(r=1),r>100&&(r=100),r},e}();t.BrightnessConverter=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HSVToRGBColorTransformer=void 0;var n=function(){function e(){}return e.convert=function(e,t){void 0===t&&(t=255);var r={red:0,green:0,blue:0};e.hue%=360;var n,o,s,i=e.brightness*e.saturation,a=i*(1-Math.abs(e.hue/60%2-1)),c=e.brightness-i;return e.hue>=0&&e.hue<60?(n=i,o=a,s=0):e.hue<120?(n=a,o=i,s=0):e.hue<180?(n=0,o=i,s=a):e.hue<240?(n=0,o=a,s=i):e.hue<300?(n=a,o=0,s=i):(n=i,o=0,s=a),r.red=Math.round((n+c)*t),r.green=Math.round((o+c)*t),r.blue=Math.round((s+c)*t),console.log("converted HSV ("+e.hue+", "+e.saturation+", "+e.brightness+") to RGB ("+r.red+", "+r.green+", "+r.blue+") max = "+t),r},e}();t.HSVToRGBColorTransformer=n}]);